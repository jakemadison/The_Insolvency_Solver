{% extends "base.html" %}
{% block content %}

    <legend>Recent Transactions
        <a onclick="beginEdits();"
           class="btn btn-xs btn-default pull-right edit_trans_btn">
            <span class="glyphicon glyphicon-pencil"></span>
            edit
         </a></legend>

    <div class="table-responsive">
            <table class="table table-striped" id="transaction_table">
              <thead>
                <tr class="info">
                  <th>Timestamp</th>
                  <th>Amount</th>
                  <th>Type</th>
                </tr>
              </thead>
              <tbody>
              {% for transaction in transactions %}

                <tr>
                  <td>{{ transaction.timestamp }}</td>
                  <td>{{ transaction.amount }}</td>
                    {%  if transaction.purchase_type %}
                  <td>{{ transaction.purchase_type }}
                      {%  else %}
                      <td>-
                    {%  endif %}

                      <span class="close_placeholder close">&nbsp;</span>
                            <button style="display: none;"
                                    class="close edit_trans_close"
                                    type="button"
                                    title="delete this transaction"
                                    id="{{ transaction.id }}"
                                    onclick="sendDeleteTransaction(this.id)">Ã—</button>
                  </td>
                </tr>

              {% endfor %}
              </tbody>
            </table>
          </div>

    <script type="application/javascript">
        function beginEdits() {
            console.log('beginning to edit transactions');
            $(".close_placeholder").hide();
            $(".edit_trans_close").show();
        }

        function sendDeleteTransaction(transaction_id) {
            console.log("attempting to send delete for: ", transaction_id);

            $.post("/delete_transaction", {transaction_id: transaction_id}, function(data) {
                console.log("result of delete post: ", data);
            }).success(function(data) {
                console.log("success!: ", data);
                $('.edit_trans_close#'+transaction_id).parent().parent().hide();
            })
        }

            //I should add a thing that changes class to "danger" on hover, instead of adding table-hover
{#        $('#elm').hover(#}
{#              function(){ $(this).addClass('hover') },#}
{#              function(){ $(this).removeClass('hover') }#}
{#            )#}

    </script>

{% endblock %}
